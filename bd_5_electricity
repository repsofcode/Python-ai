mapper.py

import sys

for line in sys.stdin:
    parts = line.strip().split(',')
    year = parts[0]
    values = list(map(int, parts[1:]))
    avg = sum(values) // len(values)
    print(f"{year}\t{avg}")

reducer.py

import sys

max_year = None
max_avg = -1

for line in sys.stdin:
    year, avg = line.strip().split('\t')
    avg = int(avg)

    if avg > max_avg:
        max_avg = avg
        max_year = year

print(max_year, max_avg)
